{"type":"data","nodes":[null,{"type":"data","data":[{"post":1,"allPosts":7},{"title":2,"date":3,"slug":4,"content":5,"tags":6},"Python Coroutines!?!?","2023-06-11","py-generator-couroutines","\u003Cp>Python supports generators which allow you to \u003Ccode>.send()\u003C/code> and recieve (via \u003Ccode>next(...)\u003C/code>) values. They are kind of like channels since they don't block until you send or recieve.\u003C/p>\n\u003Cp>In the code below, we use callbacks (called aperiodically in a separate thread) to send values to our channel. Simultaneously, we try to consume those values, which should be allowed because generators and our \u003Ccode>coroutine\u003C/code> are non-blocking.\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-python\">import time, threading\n\ndef channel(x=\"Hello\"):\n    while True:\n        x = yield x\n\ndef make_coroutine(callback):\n    def coroutine():\n        callback()\n        threading.Timer(1, coroutine).start()\n    return coroutine\n\ndef make_callback():\n    chan = channel()\n    # prime the channel\n    next(chan)\n\n    def callback():\n        print(\"Calling!\")\n        chan.send(\"Hello world!\")\n    \n    return chan, callback\n\ndef main():\n    chan, callback = make_callback()\n    coroutine = make_coroutine(callback)\n    coroutine()\n    for i in chan:\n        if i is not None:\n            print(i)\n\nif __name__ == \"__main__\":\n    main()\n\u003C/code>\u003C/pre>\n\u003Cp>And yet, this approach doesn't work as expected! One of three things happens:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>ValueError: generator already executing\u003C/code>\u003C/li>\n\u003Cli>only None values are output from the channel\u003C/li>\n\u003C/ol>\n\u003Cp>Why doesn't this work? email me if you have an answer.\u003C/p>","async,asyncio,python,coroutine,generator",[8,12,16,19,20,24,28,32,36],{"title":9,"slug":10,"date":11},"Go fast!","fast","2024-01-01",{"title":13,"slug":14,"date":15},"Consistent Hashing","consistent-hashing","2023-10-26",{"title":17,"slug":18,"date":15},"Rendevous Hashing","rendevous-hashing",{"title":2,"slug":4,"date":3},{"title":21,"slug":22,"date":23},"Lessons from Product Managing","PMing","2023-06-01",{"title":25,"slug":26,"date":27},"Einsum","einsum","2022-03-14",{"title":29,"slug":30,"date":31},"Entropy","entropy","2021-12-28",{"title":33,"slug":34,"date":35},"Try again with sudo: _sudo","_sudo","2021-11-11",{"title":37,"slug":38,"date":35},"Roku & Competition","competition-focus"],"uses":{"params":["slug"]}}]}
