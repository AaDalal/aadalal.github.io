<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.DrWrC8pZ.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.CSiO-_EV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BKjmoLrz.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/FR1t_9wV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/jQIVLDjP.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.950MbjmM.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B7wczw3A.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/KcOE5pfD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Ck1U9rAg.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.D7prmMXb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/PXRjJVOa.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DAXhhgOn.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B7Ff-sBd.js"><!--xod7dh--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous"/><!----><title>Rendevous Hashing | aagam's blog</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!--[--><!----><main><div style="[object Object]" class="full grid grid-cols-8 font-medium"><div class="col-span-8 md:col-span-2 p-4 border-2 flex flex-row justify-between items-center flex-shrink"><a class="font-bold text-xl" href="/">aadalal</a> <!--[!--><!--]--><!----></div> <div class="col-span-0 hidden md:col-span-6 py-4 px-2 border-y-2 border-r-2 md:grid grid-cols-16 gap-6 overflow-hidden whitespace-nowrap items-center justify-center"><div class="col-span-5 flex justify-end items-center flex-shrink gap-5"><!--[--><a href="/p/fast" class="opacity-75">Go fast!</a><a href="/p/consistent-hashing" class="opacity-75">Consistent Hashing</a><!--]--></div> <div class="col-span-6 flex flex-row justify-between items-center flex-shrink-0 z-10"><a id="previous-post" href="/p/consistent-hashing" aria-label="Previous post"><svg xmlns="http://www.w3.org/2000/svg" class="h-8" fill="currentColor" viewBox="144 64 224 384"><path d="M368 64L144 256l224 192V64z"></path></svg></a> <div class="shrink text-2xl font-junicode bg-white dark:bg-black">Rendevous Hashing</div> <a id="next-post" href="/p/py-generator-couroutines" aria-label="Next post"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="h-8 dark:text-white" viewBox="144 64 224 384"><path d="M144 448l224-192L144 64v384z"></path></svg></a></div> <div class="col-span-5 flex justify-start items-center flex-shrink gap-5"><!--[--><a href="/p/py-generator-couroutines" class="opacity-75">Python Coroutines!?!?</a><a href="/p/PMing" class="opacity-75">Lessons from Product Managing</a><a href="/p/einsum" class="opacity-75">Einsum</a><a href="/p/entropy" class="opacity-75">Entropy</a><a href="/p/_sudo" class="opacity-75">Try again with sudo: _sudo</a><a href="/p/competition-focus" class="opacity-75">Roku &amp; Competition</a><!--]--></div></div></div><!----> <div><article class="max-w-2xl mx-auto px-3 mt-4"><header><div class="italic opacity-75 mt-10 mb-5"><time>2023-10-26</time></div> <h1 class="text-8xl w-3/4 font-junicode mb-10">Rendevous Hashing</h1></header> <section class="prose dark:prose-invert prose-a:text-blue-600 dark:prose-a:text-blue-500 hover:prose-a:text-blue-900 hover:dark:prose-a:text-blue-800 dark:prose-pre:border-gray-900 dark:prose-pre:border"><!----><p><em>This is a follow up to my post on <a href="/p/consistent-hashing">Consistent Hashing</a> -- see that first</em></p>
<p>Consistent hashing is a technique used for distributed hash tables that assigns each key to a server in the network. It does this by hashing everything and assigning each key to the closest succeeding server hash value. Rendevous hashing is the generalization of this concept to assign a key to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> nodes. You can think about wanting to replicate a file (where it's name is the key) across <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> servers -- you need something more than consistent hashing. Another situation is where you expect that only a small number of nodes will not be part of the network at any given time (e.g., because failure probability is low but non-zero, and nodes come back over time); in this case consistent hashing would require you to rapidly reconstruct each server's mapping from key ranges to servers so that you can still query for the key from any node. Rendevous hashing solves this inefficiency by storing more keys, but preserving the nice properties of load-balancing and consistency that consistent hashing provides..</p>
<p>The idea behindrendevous hashing is that each server assigns scores to all servers (including itself) for a given key. Then they route the key to the top scorer (or to the top k, if you are rendevous hashing for replication). In particular this scoring set up needs to be <em>consistent</em> in that servers need to be able to agree on their score. It should also be even for load-balancing purposes. The scoring mechanism that fulfills both these things is simply the hash of the server's id concatenated to the key in question.</p>
<p>Read more on Randorithms.com, who has a much better <a href="https://randorithms.com/2020/12/26/rendezvous-hashing.html">write up</a>.</p><!----></section></article></div><!----></main><!----><!--]--><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_t6cd1x = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.CSiO-_EV.js"),
						import("../_app/immutable/entry/app.950MbjmM.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data: [null,{type:"data",data:{post:{title:"Rendevous Hashing",date:"2023-10-26",slug:"rendevous-hashing",content:"\u003Cp>\u003Cem>This is a follow up to my post on \u003Ca href=\"/p/consistent-hashing\">Consistent Hashing\u003C/a> -- see that first\u003C/em>\u003C/p>\n\u003Cp>Consistent hashing is a technique used for distributed hash tables that assigns each key to a server in the network. It does this by hashing everything and assigning each key to the closest succeeding server hash value. Rendevous hashing is the generalization of this concept to assign a key to \u003Cspan class=\"math math-inline\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>k\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">k\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> nodes. You can think about wanting to replicate a file (where it's name is the key) across \u003Cspan class=\"math math-inline\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>k\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">k\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> servers -- you need something more than consistent hashing. Another situation is where you expect that only a small number of nodes will not be part of the network at any given time (e.g., because failure probability is low but non-zero, and nodes come back over time); in this case consistent hashing would require you to rapidly reconstruct each server's mapping from key ranges to servers so that you can still query for the key from any node. Rendevous hashing solves this inefficiency by storing more keys, but preserving the nice properties of load-balancing and consistency that consistent hashing provides..\u003C/p>\n\u003Cp>The idea behindrendevous hashing is that each server assigns scores to all servers (including itself) for a given key. Then they route the key to the top scorer (or to the top k, if you are rendevous hashing for replication). In particular this scoring set up needs to be \u003Cem>consistent\u003C/em> in that servers need to be able to agree on their score. It should also be even for load-balancing purposes. The scoring mechanism that fulfills both these things is simply the hash of the server's id concatenated to the key in question.\u003C/p>\n\u003Cp>Read more on Randorithms.com, who has a much better \u003Ca href=\"https://randorithms.com/2020/12/26/rendezvous-hashing.html\">write up\u003C/a>.\u003C/p>"},allPosts:[{title:"Go fast!",slug:"fast",date:"2024-01-01"},{title:"Consistent Hashing",slug:"consistent-hashing",date:"2023-10-26"},{title:"Rendevous Hashing",slug:"rendevous-hashing",date:"2023-10-26"},{title:"Python Coroutines!?!?",slug:"py-generator-couroutines",date:"2023-06-11"},{title:"Lessons from Product Managing",slug:"PMing",date:"2023-06-01"},{title:"Einsum",slug:"einsum",date:"2022-03-14"},{title:"Entropy",slug:"entropy",date:"2021-12-28"},{title:"Try again with sudo: _sudo",slug:"_sudo",date:"2021-11-11"},{title:"Roku & Competition",slug:"competition-focus",date:"2021-11-11"}]},uses:{params:["slug"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
